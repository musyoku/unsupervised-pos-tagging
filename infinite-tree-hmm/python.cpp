#include "model.h"

BOOST_PYTHON_MODULE(model){
	boost::python::class_<Trainer>("ithmm")
	.def("string_to_word_id", &Trainer::string_to_word_id)
	.def("add_string", &Trainer::add_string)
	.def("perform_gibbs_sampling", &Trainer::perform_gibbs_sampling)
	.def("compile", &Trainer::compile)
	.def("load", &Trainer::load)
	.def("save", &Trainer::save)
	.def("load_textfile", &Trainer::load_textfile)
	.def("add_train_data", &Trainer::add_train_data)
	.def("add_test_data", &Trainer::add_test_data)
	.def("mark_low_frequency_words_as_unknown", &Trainer::mark_low_frequency_words_as_unknown)
	.def("update_hyperparameters", &Trainer::update_hyperparameters)
	.def("get_num_words", &Trainer::get_num_words)
	.def("get_count_for_word", &Trainer::get_count_for_word)
	.def("get_alpha", &Trainer::get_alpha)
	.def("get_gamma", &Trainer::get_gamma)
	.def("get_lambda_alpha", &Trainer::get_lambda_alpha)
	.def("get_lambda_gamma", &Trainer::get_lambda_gamma)
	.def("get_strength", &Trainer::get_strength)
	.def("get_tau0", &Trainer::get_tau0)
	.def("get_tau1", &Trainer::get_tau1)
	.def("get_metropolis_hastings_acceptance_rate", &Trainer::get_metropolis_hastings_acceptance_rate)
	.def("get_all_tags", &Trainer::get_all_tags)
	.def("set_alpha", &Trainer::set_alpha)
	.def("set_gamma", &Trainer::set_gamma)
	.def("set_lambda_alpha", &Trainer::set_lambda_alpha)
	.def("set_lambda_gamma", &Trainer::set_lambda_gamma)
	.def("set_strength", &Trainer::set_strength)
	.def("set_tau0", &Trainer::set_tau0)
	.def("set_tau1", &Trainer::set_tau1)
	.def("set_depth_limit", &Trainer::set_depth_limit)
	.def("set_metropolis_hastings_enabled", &Trainer::set_metropolis_hastings_enabled)
	.def("viterbi_decode_train", &Trainer::viterbi_decode_train)
	.def("viterbi_decode_test", &Trainer::viterbi_decode_test)
	.def("show_assigned_words_for_each_tag", &Trainer::show_assigned_words_for_each_tag)
	.def("show_assigned_words_and_probability_for_each_tag", &Trainer::show_assigned_words_and_probability_for_each_tag)
	.def("show_hpylm_for_each_tag", &Trainer::show_hpylm_for_each_tag)
	.def("show_sticks", &Trainer::show_sticks)
	.def("compute_perplexity_test", &Trainer::compute_perplexity_test)
	.def("compute_perplexity_train", &Trainer::compute_perplexity_train)
	.def("compute_log2_Pdataset_test", &Trainer::compute_log2_Pdataset_test)
	.def("compute_log2_Pdataset_train", &Trainer::compute_log2_Pdataset_train)
	.def("compute_log_Pdataset_test", &Trainer::compute_log_Pdataset_test)
	.def("compute_log_Pdataset_train", &Trainer::compute_log_Pdataset_train)
	.def("remove_all_data", &Trainer::remove_all_data);
}